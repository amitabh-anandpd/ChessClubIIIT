<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tournaments - IIIT Hyderabad Chess Club</title>
  <meta name="description" content="Upcoming and past tournaments organized by IIIT Hyderabad Chess Club. Join competitive chess events.">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/lucide/0.344.0/lucide.min.css" rel="stylesheet">
  <link rel="stylesheet" href="{% static 'css/styles.css' %}">
  <link rel="icon" href="{% static 'images/favicon.ico' %}" type="image/x-icon">
</head>
<body>
  <nav class="navbar">
    <div class="container">
      <div class="nav-content">
        <a href="{% url 'home' %}" class="nav-logo">
          IIIT Hyderabad Chess Club
        </a>

        <ul class="nav-links">
          <li><a href="{% url 'home' %}" class="nav-link">Home</a></li>
          <li><a href="{% url 'leaderboard' %}" class="nav-link">Leaderboard</a></li>
          <li><a href="{% url 'tournaments' %}" class="nav-link active">Tournaments</a></li>
          <li><a href="{% url 'newsletters' %}" class="nav-link">Newsletters</a></li>
          <li><a href="{% url 'profile' %}" class="nav-link">Profile</a></li>
        </ul>

        <div class="nav-controls">
          <button class="theme-toggle" aria-label="Toggle theme">üîÑ</button>
        </div>
      </div>
    </div>
  </nav>

  <main class="container" style="margin-top: 2rem;">
    <div class="text-center mb-6">
      <h1>Chess Tournaments</h1>
      <p class="text-muted">Competitive chess events for all skill levels</p>
    </div>

    <!-- Display messages -->
    {% if messages %}
    <div style="margin-bottom: 1.5rem;">
      {% for message in messages %}
      <div class="alert alert-{{ message.tags }}" style="padding: 1rem; border-radius: 0.5rem; margin-bottom: 0.5rem; 
           background: {% if message.tags == 'success' %}var(--success){% elif message.tags == 'error' %}var(--danger){% elif message.tags == 'warning' %}var(--warning){% else %}var(--info){% endif %}; 
           color: white;">
        {{ message }}
      </div>
      {% endfor %}
    </div>
    {% endif %}

    <!-- Upcoming Tournaments -->
      <section class="mb-6">
        <h2 class="mb-4">üèÜ Upcoming Tournaments</h2>

        {% if upcoming_tournaments %}
        <div id="upcoming-tournaments" class="grid grid-2">
          {% for t in upcoming_tournaments %}
          <div class="card tournament-card">
            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 0.5rem;">
              <h3 class="tournament-title">{{ t.name }}</h3>
              {% if t.is_multi_round %}
              <span class="badge" style="background: var(--accent); color: white; font-size: 0.75rem;">
                <i data-lucide="layers" style="width: 12px; height: 12px;"></i>
                Multi-Round
              </span>
              {% endif %}
            </div>
            
            <p class="text-muted mb-2">
              <i data-lucide="calendar" style="width: 14px; height: 14px;"></i>
              {{ t.start_date|date:"F j, Y" }}
              {% if t.end_date %} ‚Äì {{ t.end_date|date:"F j, Y" }}{% endif %}
            </p>
            
            <p class="text-muted mb-2">
              <i data-lucide="shuffle" style="width: 14px; height: 14px;"></i>
              {{ t.get_pairing_type_display }}
              {% if t.is_multi_round and t.id in tournaments_with_matches %}
              <span style="color: var(--accent);">‚Ä¢ Round {{ t.current_round }}</span>
              {% endif %}
            </p>
            
            {% if t.description %}
            <p class="text-muted mb-4">{{ t.description|truncatewords:20 }}</p>
            {% endif %}
            
            <div class="flex gap-4" style="flex-wrap: wrap;">
              {% if request.user.is_authenticated %}
                <form method="post" action="{% url 'toggle_registration' t.id %}">
                  {% csrf_token %}
                  <button type="submit" class="btn btn-primary btn-small">
                    {% if t.id in registered_ids %}
                      ‚úì Registered
                    {% else %}
                      Register
                    {% endif %}
                  </button>
                </form>
              {% endif %}
              
              <a href="{% url 'tournament_detail' t.id %}" class="btn btn-secondary btn-small">
                <i data-lucide="eye" style="width: 14px; height: 14px;"></i>
                Details
              </a>
              
              {% if is_manager %}
                {% if t.id in tournaments_with_matches %}
                  <!-- Tournament has matches -->
                  <span class="btn btn-success btn-small" style="opacity: 0.7; cursor: default;">
                    <i data-lucide="check-circle" style="width: 14px; height: 14px;"></i>
                    Matches Generated
                  </span>
                {% else %}
                  <!-- Can generate matches -->
                  <form method="post" action="{% url 'generate_matches' t.id %}">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-warning btn-small">
                      <i data-lucide="zap" style="width: 14px; height: 14px;"></i>
                      Generate Matches
                    </button>
                  </form>
                {% endif %}
              {% endif %}
            </div>
          </div>
          {% endfor %}
        </div>
        {% else %}
        <div class="card">
          <p class="text-muted text-center">No upcoming tournaments right now. Stay tuned!</p>
        </div>
        {% endif %}
      </section>

    <!-- Tournament Information -->
    <div class="card mb-6">
      <h3>Tournament Information</h3>
      <div class="grid grid-2">
        <div>
          <h4>Registration Process</h4>
          <p>All club members can participate in our tournaments. Registration typically opens 2 weeks before each event.</p>
          <ul style="margin-left: 1.5rem; margin-top: 0.5rem;">
            <li>Fill out the registration form</li>
            <li>Pay the entry fee (if applicable)</li>
            <li>Receive confirmation and pairing details</li>
            <li>Attend the player's meeting</li>
          </ul>
        </div>
        <div>
          <h4>Tournament Formats</h4>
          <p>We organize various formats to suit different preferences and skill levels:</p>
          <ul style="margin-left: 1.5rem; margin-top: 0.5rem;">
            <li><strong>Random:</strong> Players paired randomly</li>
            <li><strong>Round Robin:</strong> Everyone plays everyone</li>
            <li><strong>Swiss System:</strong> Pair players with similar scores</li>
            <li><strong>Knockout:</strong> Single elimination bracket</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Time Controls -->
    <div class="card mb-6">
      <h3>Time Control Formats</h3>
      <div class="grid grid-3">
        <div class="text-center" style="padding: 1rem; border: 1px solid var(--border); border-radius: 0.5rem;">
          <div style="font-size: 2rem; margin-bottom: 0.5rem;">‚ö°</div>
          <h4>Blitz</h4>
          <p class="text-muted">3-10 minutes per player</p>
        </div>
        <div class="text-center" style="padding: 1rem; border: 1px solid var(--border); border-radius: 0.5rem;">
          <div style="font-size: 2rem; margin-bottom: 0.5rem;">üèÉ</div>
          <h4>Rapid</h4>
          <p class="text-muted">10-30 minutes per player</p>
        </div>
        <div class="text-center" style="padding: 1rem; border: 1px solid var(--border); border-radius: 0.5rem;">
          <div style="font-size: 2rem; margin-bottom: 0.5rem;">‚ôüÔ∏è</div>
          <h4>Classical</h4>
          <p class="text-muted">30+ minutes per player</p>
        </div>
      </div>
    </div>

    <!-- Tournament Rules -->
    <div class="card mb-6">
      <h3>Tournament Rules & Guidelines</h3>
      <div class="grid grid-2">
        <div>
          <h4>General Rules</h4>
          <ul style="margin-left: 1.5rem;">
            <li>FIDE Laws of Chess apply to all tournaments</li>
            <li>No outside assistance or electronic devices</li>
            <li>Players must record their games in classical events</li>
            <li>Punctuality is required - default time is 30 minutes</li>
            <li>Respectful conduct expected at all times</li>
          </ul>
        </div>
        <div>
          <h4>Rating & Prizes</h4>
          <ul style="margin-left: 1.5rem;">
            <li>All rated tournaments affect club rankings</li>
            <li>Prizes awarded for top finishers</li>
            <li>Special recognition for best junior performance</li>
            <li>Rating categories may have separate prizes</li>
            <li>Perfect attendance awards for regular players</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Tournament Format Explanations -->
    <div class="card mb-6">
      <h3>Understanding Tournament Formats</h3>
      
      <div style="margin-bottom: 2rem;">
        <h4 style="color: var(--accent);">
          <i data-lucide="shuffle" style="width: 18px; height: 18px;"></i>
          Swiss System
        </h4>
        <p>Players are paired each round based on their current score. Those with similar scores face each other. No one is eliminated - all players participate in every round. Typically runs 5-7 rounds depending on the number of participants.</p>
        <p class="text-muted" style="font-size: 0.9rem; margin-top: 0.5rem;">
          <strong>Best for:</strong> Competitive tournaments where you want a clear winner without eliminating players.
        </p>
      </div>
      
      <div style="margin-bottom: 2rem;">
        <h4 style="color: var(--accent);">
          <i data-lucide="trophy" style="width: 18px; height: 18px;"></i>
          Knockout
        </h4>
        <p>Single elimination bracket format. Players are paired in the first round, and winners advance to the next round while losers are eliminated. Continues until only one player remains as champion.</p>
        <p class="text-muted" style="font-size: 0.9rem; margin-top: 0.5rem;">
          <strong>Best for:</strong> Fast-paced tournaments with clear bracket progression and a dramatic finals match.
        </p>
      </div>
      
      <div>
        <h4 style="color: var(--accent);">
          <i data-lucide="grid" style="width: 18px; height: 18px;"></i>
          Round Robin
        </h4>
        <p>Every player faces every other player exactly once. The player with the highest score at the end wins. Ensures fairness as everyone plays the same opponents.</p>
        <p class="text-muted" style="font-size: 0.9rem; margin-top: 0.5rem;">
          <strong>Best for:</strong> Smaller tournaments (under 12 players) where you want comprehensive head-to-head results.
        </p>
      </div>
    </div>

    <!-- Call to Action -->
    <div class="card text-center" style="background: linear-gradient(135deg, var(--accent), var(--accent-hover)); color: white;">
      <div style="padding: 1rem;">
        <h3 style="color: white; margin-bottom: 1rem;">Ready to Compete?</h3>
        <p style="color: rgba(255,255,255,0.9); margin-bottom: 2rem;">
          Join our next tournament and test your skills against fellow club members.
          All skill levels welcome!
        </p>
        <div class="flex gap-4 justify-center">
          <a href="mailto:chessclub@students.iiit.ac.in?subject=Tournament Registration"
             class="btn" style="background: white; color: var(--accent);">
            Register Now
          </a>
          <a href="{% url 'leaderboard' %}"
             class="btn" style="border: 2px solid white; background: transparent; color: white;">
            View Rankings
          </a>
        </div>
      </div>
    </div>
  </main>

  <footer class="footer">
    <div class="container">
      <div class="footer-content">
        <div class="footer-links">
          <a href="mailto:chessclub@students.iiit.ac.in">chessclub@students.iiit.ac.in</a>
          <a href="#">Chess.com Team</a>
          <a href="#">Lichess Team</a>
          <a href="https://www.instagram.com/chessclub.iiith">Instagram</a>
        </div>
        <div class="footer-info">
          <p>&copy; 2025 IIIT Hyderabad Chess Club. Part of the International Institute of Information Technology, Hyderabad.</p>
        </div>
      </div>
    </div>
  </footer>
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
  <script type='module' src="{% static 'js/main.js' %}"></script>
</body>
</html>